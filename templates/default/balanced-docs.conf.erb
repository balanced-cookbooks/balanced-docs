server {
    listen        80;
    server_name   docs.balancedpayments.com;
    rewrite       ^(.*) https://docs.balancedpayments.com$1 permanent;
}

server {
    listen        443;
    server_name   docs.balancedpayments.com;
    #ssl           on;
    #ssl_certificate       /etc/nginx/balancedpayments.com.crt;
    #ssl_certificate_key   /etc/nginx/balancedpayments.com.pem;
    keepalive_timeout     70;

    gzip              on;
    gzip_min_length   1000;
    gzip_http_version 1.0;
    gzip_proxied      any;
    gzip_types        text/plain
                      application/xml
                      application/json
                      text/css
                      text/javascript
                      image/svg+xml
                      application/vnd.ms-fontobject
                      application/x-font-woff
                      font/truetype
                      font/opentype
                      application/x-font-ttf;
    gzip_disable      "MSIE [1-6]\.";
    gzip_vary         on;

    send_timeout 360s;
    client_body_timeout 360s;

    ssi on;

    root /var/lib/justice/docs;

    location = / {
         rewrite ^/(.*)$ /current/ permanent;
    }

    location = /logs/errors {
        return 204;
    }

    location ~ ^/(api|overview|spec)/?$ {
        rewrite ^/(.*?)/?$ /current/$1 permanent;
    }

    location ~ ^/(\w+)/(api|overview)/?$ {
        rewrite ^/(.*?)/?$ /$1.html last;
    }

    location ~ ^/(\w+)/?$ {
        rewrite ^/(.*?)/?$ /$1/overview/ last;
    }

    location / {
    }
}
